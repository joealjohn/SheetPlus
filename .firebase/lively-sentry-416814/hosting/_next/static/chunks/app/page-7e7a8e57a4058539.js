(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2751:(e,t,a)=>{Promise.resolve().then(a.bind(a,5987))},5987:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ew});var s=a(5155),r=a(2115),l=a(6874),n=a.n(l);function i(e){return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,s.jsx)("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",fill:"hsl(var(--primary))",stroke:"none"}),(0,s.jsx)("path",{d:"M8 12h8",stroke:"hsl(var(--primary-foreground))"}),(0,s.jsx)("path",{d:"M12 8v8",stroke:"hsl(var(--primary-foreground))"}),(0,s.jsx)("path",{d:"M17.5 3.5c1.1 0 2 .9 2 2v0c0 1.1-.9 2-2 2h-1c-1.1 0-2-.9-2-2v-1c0-1.1.9-2 2-2h1z",fill:"hsl(var(--accent))",stroke:"hsl(var(--primary))",strokeWidth:"1.5"})]})}var d=a(6936),o=a(8027),c=a(1362),m=a(4253),u=a(2085),f=a(9434);let p=(0,u.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),x=r.forwardRef((e,t)=>{let{className:a,variant:r,size:l,asChild:n=!1,...i}=e,d=n?m.DX:"button";return(0,s.jsx)(d,{className:(0,f.cn)(p({variant:r,size:l,className:a})),ref:t,...i})});x.displayName="Button";var h=a(551),g=a(3158),v=a(518),j=a(154);let N=h.bL,b=h.l9;h.YJ,h.ZL,h.Pb,h.z6,r.forwardRef((e,t)=>{let{className:a,inset:r,children:l,...n}=e;return(0,s.jsxs)(h.ZP,{ref:t,className:(0,f.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...n,children:[l,(0,s.jsx)(g.A,{className:"ml-auto"})]})}).displayName=h.ZP.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(h.G5,{ref:t,className:(0,f.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=h.G5.displayName;let y=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...l}=e;return(0,s.jsx)(h.ZL,{children:(0,s.jsx)(h.UC,{ref:t,sideOffset:r,className:(0,f.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});y.displayName=h.UC.displayName;let w=r.forwardRef((e,t)=>{let{className:a,inset:r,...l}=e;return(0,s.jsx)(h.q7,{ref:t,className:(0,f.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...l})});function k(){let{setTheme:e}=(0,c.D)();return(0,s.jsxs)(N,{children:[(0,s.jsx)(b,{asChild:!0,children:(0,s.jsxs)(x,{variant:"outline",size:"icon",children:[(0,s.jsx)(d.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,s.jsx)(o.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,s.jsxs)(y,{align:"end",children:[(0,s.jsx)(w,{onClick:()=>e("light"),children:"Light"}),(0,s.jsx)(w,{onClick:()=>e("dark"),children:"Dark"}),(0,s.jsx)(w,{onClick:()=>e("system"),children:"System"})]})]})}function C(){return(0,s.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-card/80 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"container mx-auto flex h-16 max-w-7xl items-center justify-between px-4 md:px-8",children:[(0,s.jsxs)(n(),{href:"/",className:"flex items-center gap-2",children:[(0,s.jsx)(i,{className:"h-8 w-8"}),(0,s.jsx)("span",{className:"text-xl font-bold tracking-tight text-foreground",children:"Sheets+"})]}),(0,s.jsx)(k,{})]})})}w.displayName=h.q7.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:l,...n}=e;return(0,s.jsxs)(h.H_,{ref:t,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:l,...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(h.VF,{children:(0,s.jsx)(v.A,{className:"h-4 w-4"})})}),r]})}).displayName=h.H_.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(h.hN,{ref:t,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(h.VF,{children:(0,s.jsx)(j.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=h.hN.displayName,r.forwardRef((e,t)=>{let{className:a,inset:r,...l}=e;return(0,s.jsx)(h.JU,{ref:t,className:(0,f.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...l})}).displayName=h.JU.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(h.wv,{ref:t,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=h.wv.displayName;var A=a(2448),R=a(172),T=a(7607),E=a(7933),S=a(9829),D=a(9311),_=a(5300),z=a(5481),P=a(7481),O=a(4477);let I=(0,O.createServerReference)("40b1e43e69fbd4f70155dd1099ed11a1ad158943a3",O.callServer,void 0,O.findSourceMapURL,"extractTextFromImage");var U=a(5821),F=a(5318);let L=U.bL,M=U.l9,V=U.ZL;U.bm;let G=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(U.hJ,{ref:t,className:(0,f.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});G.displayName=U.hJ.displayName;let H=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(V,{children:[(0,s.jsx)(G,{}),(0,s.jsxs)(U.UC,{ref:t,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[r,(0,s.jsxs)(U.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(F.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});H.displayName=U.UC.displayName;let B=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};B.displayName="DialogHeader";let J=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};J.displayName="DialogFooter";let W=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(U.hE,{ref:t,className:(0,f.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});W.displayName=U.hE.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(U.VY,{ref:t,className:(0,f.cn)("text-sm text-muted-foreground",a),...r})}).displayName=U.VY.displayName;let Y=(0,u.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),q=r.forwardRef((e,t)=>{let{className:a,variant:r,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,f.cn)(Y({variant:r}),a),...l})});q.displayName="Alert";let Z=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,f.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})});Z.displayName="AlertTitle";let X=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,f.cn)("text-sm [&_p]:leading-relaxed",a),...r})});X.displayName="AlertDescription";let K=e=>e.trim().split("\n").map(e=>e.split(",").map(e=>{let t=e.trim();return t.startsWith('"')&&t.endsWith('"')&&(t=t.substring(1,t.length-1)),t}));function Q(e){let{onDataExtracted:t,onProcessing:a}=e,[l,n]=(0,r.useState)(!1),{toast:i}=(0,P.dj)(),[d,o]=(0,r.useState)(!1),[c,m]=(0,r.useState)(!1),[u,f]=(0,r.useState)(null),p=(0,r.useRef)(null),h=(0,r.useRef)(null),g=(0,r.useRef)(null),v=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:!0});g.current=e,p.current&&(p.current.srcObject=e),f(!0)}catch(e){console.error("Error accessing camera:",e),f(!1),i({variant:"destructive",title:"Camera Access Denied",description:"Please enable camera permissions in your browser settings to use this feature."})}};(0,r.useEffect)(()=>{c?v():g.current&&(g.current.getTracks().forEach(e=>e.stop()),g.current=null)},[c]);let j=(0,r.useCallback)(async e=>{if(!e)return void i({title:"No file selected",description:"Please select a file to upload.",variant:"destructive"});if(!["image/jpeg","image/png","application/pdf"].includes(e.type))return void i({title:"Invalid file type",description:"Please upload a JPG, PNG, or PDF file. You uploaded a ".concat(e.type," file."),variant:"destructive"});a(!0),o(!0);try{let s=new FileReader;s.onloadend=async()=>{let r=s.result;try{let a=await I({imageDataUri:r}),s=K(a.extractedText);t(s,e),i({title:"Success!",description:"Data has been extracted from your file.",variant:"default"})}catch(e){console.error("Error extracting text:",e),i({title:"Error",description:"Failed to extract data from the file. Please try again.",variant:"destructive"}),a(!1)}finally{o(!1)}},s.readAsDataURL(e)}catch(e){console.error("Error reading file:",e),i({title:"Error",description:"Could not read the selected file.",variant:"destructive"}),a(!1),o(!1)}},[t,a,i]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-all duration-300 ".concat(l?"border-primary bg-primary/10":"border-border hover:border-primary/50"," ").concat(d?"pointer-events-none":""),onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),n(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),n(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{var t;e.preventDefault(),e.stopPropagation(),n(!1),j((null==(t=e.dataTransfer.files)?void 0:t[0])||null)},children:[(0,s.jsx)("input",{type:"file",id:"file-input",className:"hidden",onChange:e=>{var t;j((null==(t=e.target.files)?void 0:t[0])||null)},accept:"image/png, image/jpeg, application/pdf",disabled:d}),d?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 text-primary",children:[(0,s.jsx)(R.A,{className:"w-12 h-12 animate-spin"}),(0,s.jsx)("p",{className:"font-semibold",children:"Extracting data..."}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Please wait while we process your file."})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(T.A,{className:"w-12 h-12 transition-colors ".concat(l?"text-primary":"text-muted-foreground")}),(0,s.jsx)("p",{className:"font-semibold",children:"Drag & drop your file here"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"or"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(x,{onClick:()=>{var e;null==(e=document.getElementById("file-input"))||e.click()},disabled:d,children:[(0,s.jsx)(A.A,{className:"mr-2 h-4 w-4"})," Browse Files"]}),(0,s.jsxs)(L,{open:c,onOpenChange:m,children:[(0,s.jsx)(M,{asChild:!0,children:(0,s.jsxs)(x,{variant:"outline",children:[(0,s.jsx)(E.A,{className:"mr-2 h-4 w-4"})," Use Camera"]})}),(0,s.jsxs)(H,{className:"max-w-3xl",children:[(0,s.jsx)(B,{children:(0,s.jsx)(W,{children:"Camera"})}),!1===u&&(0,s.jsxs)(q,{variant:"destructive",children:[(0,s.jsx)(Z,{children:"Camera Access Required"}),(0,s.jsx)(X,{children:"Please allow camera access in your browser to use this feature."})]}),u&&(0,s.jsx)("div",{children:(0,s.jsx)("video",{ref:p,className:"w-full aspect-video rounded-md bg-muted",autoPlay:!0,muted:!0,playsInline:!0})}),(0,s.jsxs)(J,{children:[(0,s.jsx)(x,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),(0,s.jsxs)(x,{onClick:()=>{if(p.current&&h.current){let e=p.current,t=h.current;t.width=e.videoWidth,t.height=e.videoHeight;let a=t.getContext("2d");a&&(a.drawImage(e,0,0,e.videoWidth,e.videoHeight),t.toBlob(e=>{e&&(j(new A.A([e],"capture.jpg",{type:"image/jpeg"})),m(!1))},"image/jpeg"))}},disabled:!u,children:[(0,s.jsx)(S.A,{className:"mr-2 h-4 w-4"})," Capture"]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 text-muted-foreground mt-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(D.A,{className:"h-4 w-4"})," JPG, PNG"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(_.A,{className:"h-4 w-4"})," PDF"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(z.A,{className:"h-4 w-4"})," Camera"]})]})]})]}),(0,s.jsx)("canvas",{ref:h,className:"hidden"})]})}let $=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,f.cn)("w-full caption-bottom text-sm",a),...r})})});$.displayName="Table";let ee=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,f.cn)("[&_tr]:border-b",a),...r})});ee.displayName="TableHeader";let et=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,f.cn)("[&_tr:last-child]:border-0",a),...r})});et.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,f.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let ea=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,f.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});ea.displayName="TableRow";let es=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,f.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});es.displayName="TableHead";let er=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,f.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});er.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("caption",{ref:t,className:(0,f.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption";let el=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,f.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...l})});el.displayName="Input";var en=a(4301),ei=a(8718),ed=a(7223),eo=a(8082);let ec=eo.Kq,em=eo.bL,eu=eo.l9,ef=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...l}=e;return(0,s.jsx)(eo.UC,{ref:t,sideOffset:r,className:(0,f.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})});ef.displayName=eo.UC.displayName;var ep=a(1092),ex=a(1540);function eh(e){let{initialData:t}=e,[a,l]=(0,r.useState)(t),{toast:n}=(0,P.dj)();(0,r.useEffect)(()=>{l(t)},[t]);let i=(e,t,s)=>{let r=[...a];r[t][s]=e.target.value,l(r)},d=()=>{if(0===a.length||0===a[0].length)return void l([[""]]);let e=Array(a[0].length).fill("");l([...a,e])},o=e=>{l(a.filter((t,a)=>a!==e))},c=e=>{l(a.map(t=>t.filter((t,a)=>a!==e)))};if(0===a.length)return(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"No data to display. Add a row to start."}),(0,s.jsxs)(x,{onClick:d,className:"mt-4",children:[(0,s.jsx)(en.A,{className:"mr-2 h-4 w-4"})," Add Row"]})]});let m=a.length>0?a[0]:[],u=a.length>1?a.slice(1):[];return(0,s.jsx)(ec,{children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4 flex-wrap gap-2",children:[(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsxs)(x,{onClick:d,variant:"outline",size:"sm",children:[(0,s.jsx)(en.A,{className:"mr-2 h-4 w-4"})," Add Row"]}),(0,s.jsxs)(x,{onClick:()=>{if(0===a.length)return void l([[""]]);l(a.map(e=>[...e,""]))},variant:"outline",size:"sm",children:[(0,s.jsx)(en.A,{className:"mr-2 h-4 w-4"})," Add Column"]})]}),(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsxs)(x,{onClick:()=>{if(0===a.length)return void n({title:"Export Failed",description:"There is no data to export.",variant:"destructive"});let e=new ep.XIK({width:{size:100,type:ep.PsV.PERCENTAGE},rows:a.map((e,t)=>new ep.Hjg({children:e.map(e=>new ep.nA6({children:[new ep.fzL({children:[new ep.NTc({text:e,bold:0===t})]})]}))}))}),t=new ep.yoT({sections:[{children:[e]}]});ep.ND6.toBlob(t).then(e=>{(0,ex.saveAs)(e,"exported_data.docx"),n({title:"Export Successful",description:"Your data has been exported as a Word document.",variant:"default"})})},variant:"default",size:"sm",children:[(0,s.jsx)(_.A,{className:"mr-2 h-4 w-4"})," Export Word"]}),(0,s.jsxs)(x,{onClick:()=>{let e=a.length>0?a[0]:[],t=a.length>1?a.slice(1):[],s=e=>{let t=e.replace(/"/g,'""');return t.includes(",")||t.includes('"')||t.includes("\n")?'"'.concat(t,'"'):t},r=e.map(s).join(",")+"\r\n";t.forEach(e=>{r+=e.map(s).join(",")+"\r\n"});let l=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");i.href&&URL.revokeObjectURL(i.href),i.href=URL.createObjectURL(l),i.setAttribute("download","exported_data.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i),n({title:"Export Successful",description:"Your data has been exported as a CSV file.",variant:"default"})},variant:"default",size:"sm",children:[(0,s.jsx)(ei.A,{className:"mr-2 h-4 w-4"})," Export CSV"]})]})]}),(0,s.jsx)("div",{className:"relative overflow-x-auto border rounded-lg",children:(0,s.jsxs)($,{children:[(0,s.jsx)(ee,{children:(0,s.jsxs)(ea,{className:"bg-muted/50",children:[(0,s.jsx)(es,{className:"w-12"}),m.map((e,t)=>(0,s.jsxs)(es,{className:"relative group p-2 min-w-[150px]",children:[(0,s.jsx)(el,{type:"text",value:a[0][t],onChange:e=>i(e,0,t),className:"font-bold border-0 bg-transparent"}),(0,s.jsxs)(em,{children:[(0,s.jsx)(eu,{asChild:!0,children:(0,s.jsx)(x,{variant:"ghost",size:"icon",className:"absolute right-0 top-1/2 -translate-y-1/2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>c(t),children:(0,s.jsx)(F.A,{className:"h-4 w-4"})})}),(0,s.jsx)(ef,{children:(0,s.jsx)("p",{children:"Delete Column"})})]})]},t))]})}),(0,s.jsx)(et,{children:u.map((e,t)=>(0,s.jsxs)(ea,{className:"group",children:[(0,s.jsx)(er,{className:"relative p-2",children:(0,s.jsxs)(em,{children:[(0,s.jsx)(eu,{asChild:!0,children:(0,s.jsx)(x,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>o(t+1),children:(0,s.jsx)(ed.A,{className:"h-4 w-4 text-destructive"})})}),(0,s.jsx)(ef,{children:(0,s.jsx)("p",{children:"Delete Row"})})]})}),e.map((e,a)=>(0,s.jsx)(er,{className:"p-2 min-w-[150px]",children:(0,s.jsx)(el,{type:"text",value:e,onChange:e=>i(e,t+1,a),className:"w-full"})},a))]},t))})]})})]})})}let eg=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,f.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});eg.displayName="Card";let ev=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...r})});ev.displayName="CardHeader";let ej=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});ej.displayName="CardTitle";let eN=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,f.cn)("text-sm text-muted-foreground",a),...r})});eN.displayName="CardDescription";let eb=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,f.cn)("p-6 pt-0",a),...r})});function ey(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,f.cn)("animate-pulse rounded-md bg-muted",t),...a})}function ew(){let[e,t]=(0,r.useState)(null),[a,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null);return(0,s.jsxs)("div",{className:"flex min-h-screen w-full flex-col",children:[(0,s.jsx)(C,{}),(0,s.jsx)("main",{className:"flex-1 bg-background",children:(0,s.jsx)("div",{className:"container mx-auto max-w-7xl p-4 py-8 md:p-8",children:(0,s.jsxs)("div",{className:"grid gap-8",children:[(0,s.jsxs)(eg,{className:"shadow-md hover:shadow-lg transition-shadow duration-300",children:[(0,s.jsxs)(ev,{children:[(0,s.jsx)(ej,{className:"text-2xl font-headline",children:"The most powerful AI to extract data from images to sheets"}),(0,s.jsx)(eN,{children:"Extract data from your images with up to 95% accuracy, even from handwritten notes. No sign-up required, enjoy free and unlimited usage. Upload an image (JPG, PNG) or a PDF to start."})]}),(0,s.jsx)(eb,{children:(0,s.jsx)(Q,{onDataExtracted:(e,a)=>{t(e),i({name:a.name,type:a.type}),l(!1)},onProcessing:e=>{l(e),e&&(t(null),i(null))}})})]}),a&&(0,s.jsx)(()=>(0,s.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(ey,{className:"h-12 w-12 rounded-lg"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(ey,{className:"h-4 w-[250px]"}),(0,s.jsx)(ey,{className:"h-4 w-[200px]"})]})]}),(0,s.jsx)(ey,{className:"h-10 w-full"}),(0,s.jsx)(ey,{className:"h-40 w-full"})]}),{}),!a&&e&&n&&(0,s.jsxs)(eg,{className:"shadow-md",children:[(0,s.jsxs)(ev,{children:[(0,s.jsx)(ej,{className:"text-2xl font-headline",children:"Extracted Data"}),(0,s.jsxs)(eN,{children:["Review and edit the extracted data from ",(0,s.jsx)("span",{className:"font-medium text-primary",children:n.name}),". You can add or remove rows and columns."]})]}),(0,s.jsx)(eb,{children:(0,s.jsx)(eh,{initialData:e})})]})]})})}),(0,s.jsx)("footer",{className:"py-4 text-center text-sm text-muted-foreground",children:"Developed by Ace using Firebase Studio"})]})}eb.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,f.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},7481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>u});var s=a(2115);let r=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=i(o,e),d.forEach(e=>{e(o)})}function m(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function u(){let[e,t]=s.useState(o);return s.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(2596),r=a(9688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[797,254,326,441,684,358],()=>t(2751)),_N_E=e.O()}]);